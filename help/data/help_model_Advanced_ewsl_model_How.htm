<div class="markdown-body"><h1>如何使用脚本建模</h1><h2>操作步骤</h2><a name="help_model_Advanced_ewsl_model_How.step1"> </a><h3>1.新建脚本文件</h3>任意工作目录下新建文本文档，并将文本文档重命名为<code>.ewp2</code>格式。<a name="help_model_Advanced_ewsl_model_How.step2"> </a><h3>2.初始化模型文档</h3><blockquote>EastWave V7 模型文档定义了<strong>计算模式</strong>、<strong>变量表</strong>、<strong>顶层模块</strong>、<strong>基础参数</strong>、<strong>调度器</strong>、<strong>网格属性</strong>。<br />
用户使用脚本建模，实际上就是在<strong>顶层模块</strong>中添加新的几何元件。<br />
</blockquote>打开并编辑脚本文件，添加以下代码初始化模型文档：<pre><code code-language="ewsl">td.beg("doc","DDocument");<br />	//定义模型文档<br />	td.beg("default","DTemplateBasic");<br />		td.set("workmode","workmode1");		//工作模式<br />		td.set("variable","vartable");		//变量表<br />		td.set("topgroup1","topgroup1");	//顶层模块<br />		td.set("parameter","param");		//基础参数<br />		td.set("dispatcher1","");		//调度器<br />		td.set("dispatcher2","");<br />		td.set("meshsetting","meshsetting");	//网格属性<br />	td.end();<br />	<br />	//定义工作模式<br />	td.beg("workmode1","DWorkmodeCustom");<br />		td.set("unit","");<br />	td.end();<br />	<br />	//定义变量表<br />	td.beg("vartable","DVariable");<br />		td.set("variables",[]);<br />	td.end();<br />	<br />	//定义顶层模块<br />	td.beg("topgroup1","DSymbolGrp");<br />		td.set("unit","");<br />		td.set("meshinfo","");<br />		td.set("material","");<br />		td.set("n_dp_level",0x0);<br />		td.set("transforms",[]);<br />		td.set("children",["cube"]);		//添加长方体几何元件到顶层模块<br />		td.set("reference","");<br />	td.end();<br />	<br />	//定义长方体几何元件<br />	td.beg("cube","DShapeCube");<br />		td.set("unit","");<br />		td.set("opt_type#Cube#Shape",0x0);<br />		td.set("x3e_center.x#Cube#Shape","0.0");<br />		td.set("x3e_center.y#Cube#Shape","0.0");<br />		td.set("x3e_center.z#Cube#Shape","0.0");<br />		td.set("x3e_width.x#Cube#Shape","100.0");<br />		td.set("x3e_width.y#Cube#Shape","100.0");<br />		td.set("x3e_width.z#Cube#Shape","100.0");<br />		td.set("u3e_corner_1.u#Cube#Shape","0.0");<br />		td.set("u3e_corner_1.v#Cube#Shape","0.0");<br />		td.set("u3e_corner_1.n#Cube#Shape","0.0");<br />		td.set("u3e_corner_2.u#Cube#Shape","10.0");<br />		td.set("u3e_corner_2.v#Cube#Shape","10.0");<br />		td.set("u3e_corner_2.n#Cube#Shape","10.0");<br />		td.set("mvm_arrayvec3#Cube#Shape",[["1.0","0.0","0.0",20],["0.0","1.0","0.0",20],["0.0","0.0","1.0",20]]);<br />	td.end();<br /><br />	//定义基础参数<br />	td.beg("param","DParameter");<br />		td.set("unit","unit");<br />		td.set("bgmat","air");<br />		td.set("fbox.lo.x","-300");<br />		td.set("fbox.lo.y","-300");<br />		td.set("fbox.lo.z","-300");<br />		td.set("fbox.hi.x","300");<br />		td.set("fbox.hi.y","300");<br />		td.set("fbox.hi.z","300");<br />		td.set("border.lo.x",0x0);<br />		td.set("border.lo.y",0x0);<br />		td.set("border.lo.z",0x0);<br />		td.set("border.hi.x",0x0);<br />		td.set("border.hi.y",0x0);<br />		td.set("border.hi.z",0x0);<br />		td.set("time.step_max","1000");<br />		td.set("time.time_max","4000");<br />		td.set("time.dt_ratio","1.6/2.25");<br />		td.set("time.dt_reference","1.0");<br />		td.set("time.policy",0xFFFFFFFFFFFFFFFF);<br />		td.set("pml.size","12");<br />		td.set("pml.type",0x0);<br />		td.set("freq.min","1.0");<br />		td.set("freq.max","2.0");<br />		td.set("flags",0x0);<br />	td.end();<br />	<br />	//定义单位<br />	td.beg("unit","DUnit");<br />		td.set("ul.type",0x0);<br />		td.set("ul.expr","1.0e-3");<br />		td.set("ut.type",0x0);<br />		td.set("ut.expr","1.0e-9");<br />		td.set("uf.type",0x0);<br />		td.set("uf.expr","1.0e9");<br />		td.set("flags",0x0);<br />	td.end();<br /><br />	//定义普通材料<br />	td.beg("air","DMaterialSimple");<br />		td.set("unit","");<br />		td.set("material.color",0xFFE09C8B);<br />		td.set("material.extra",0x0);<br />		td.set("eps","1");<br />		td.set("sge","0");<br />		td.set("xmu","1");<br />		td.set("sgm","0");<br />	td.end();<br /><br />	//定义网格属性<br />	td.beg("meshsetting","DMeshsetting");<br />		td.set("meshinfo.basic.flags",0x0);<br />		td.set("meshinfo.basic.delta.x",10);<br />		td.set("meshinfo.basic.delta.y",10);<br />		td.set("meshinfo.basic.delta.z",10);<br />		td.set("meshinfo.basic.extend.x",0);<br />		td.set("meshinfo.basic.extend.y",0);<br />		td.set("meshinfo.basic.extend.z",0);<br />		td.set("meshinfo.refine.flags",0x27);<br />		td.set("meshinfo.refine.edge_factor",1);<br />		td.set("meshinfo.refine.vol_factor",1);<br />		td.set("meshinfo.snapping.flags",0x1);<br />		td.set("meshinfo.config.flags",0x400);<br />		td.set("meshinfo.config.edge_fraction",3);<br />		td.set("meshinfo.config.vol_smooth_ratio",1.1);<br />		td.set("meshinfo.config.edge_additional_fine_cells",0x3);<br />		td.set("meshinfo.config.vol_additional_fine_cells",0x3);<br />		td.set("meshinfo.config.weight_near.x",1);<br />		td.set("meshinfo.config.weight_near.y",1);<br />		td.set("meshinfo.config.weight_near.z",1);<br />		td.set("meshinfo.config.weight_far.x",1);<br />		td.set("meshinfo.config.weight_far.y",1);<br />		td.set("meshinfo.config.weight_far.z",1);<br />		td.set("meshinfo.config.num_near",15);<br />		td.set("meshinfo.config.num_far",15);<br />		td.set("meshinfo.mesh.type",0x0);<br />		td.set("meshinfo.mesh.grid.x","50");<br />		td.set("meshinfo.mesh.grid.y","50");<br />		td.set("meshinfo.mesh.grid.z","50");<br />		td.set("meshinfo.fillmethod",0x0);<br />		td.set("meshinfo.conformal.level_e",0x0);<br />		td.set("meshinfo.conformal.level_h",0x0);<br />		td.set("meshinfo.conformal.line_policy",0x1);<br />		td.set("meshinfo.conformal.line_fc_policy",0x0);<br />		td.set("meshinfo.conformal.SC_error",0);<br />	td.end();<br /><br />	td.run(0);<br />td.end();</code></pre><a name="help_model_Advanced_ewsl_model_How.step3"> </a><h3>3.添加几何元件</h3>对于脚本建模来说，以上脚本代码中，最重要的部分是：<pre><code code-language="ewsl">//定义顶层模块<br />td.beg("topgroup1","DSymbolGrp");<br />	......<br />	td.set("children",["cube"]);		//添加长方体几何元件到顶层模块<br />	......<br />td.end();<br /><br />//定义长方体几何元件<br />td.beg("cube","DShapeCube");<br />	......<br />td.end();</code></pre>添加新的几何元件也比较简单：定义了新的几何元件后，只需要把几何元件名称添加到<code>topgroup1</code>的<code>children</code>属性中即可。<pre><code code-language="ewsl">/*下面这段脚本代码，定义了一个新的圆柱体几何元件，并将其添加到了顶层模块topgroup1。*/<br /><br />//定义顶层模块<br />td.beg("topgroup1","DSymbolGrp");<br />	......<br />	td.set("children",["cube","cylinder"]);		//添加新定义的圆柱体到顶层模块中<br />	......<br />td.end();<br /><br />//定义长方体几何元件<br />td.beg("cube","DShapeCube");<br />	......<br />td.end();<br /><br />//定义圆柱体几何元件<br />td.beg("cylinder","DShapeCylinder");<br />	......<br />td.end();</code></pre><blockquote><strong>相关文档：</strong><br />
<div class="markdown-block"><table width="100%"><tr style="border:0px"><td style="border:0px"><div class="markdown-table"><table width="100%" class="markdown-table" style="border:1px"><thead><tr><td rowspan="1" colspan="5" align="center">几何元件脚本参数说明 </td></tr></thead><tbody><tr><td align="center"> <a target="_top" href="#help_model_Advanced_ewsl_model_How.cube">长方体</a> </td><td align="center"> <a target="_top" href="#help_model_Advanced_ewsl_model_How.cylinder">圆柱体</a> </td><td align="center"> <a target="_top" href="#help_model_Advanced_ewsl_model_How.sphere">球体</a> </td><td align="center"> <a target="_top" href="#help_model_Advanced_ewsl_model_How.geosphere">几何球体</a> </td><td align="center"> <a target="_top" href="#help_model_Advanced_ewsl_model_How.cone">圆锥体</a> </td></tr><tr><td align="center"> <a target="_top" href="#help_model_Advanced_ewsl_model_How.torus">环体</a> </td><td align="center"> <a target="_top" href="#help_model_Advanced_ewsl_model_How.spin">实心旋转体</a> </td><td align="center"> <a target="_top" href="#help_model_Advanced_ewsl_model_How.spin2">空心旋转体</a> </td><td align="center"> <a target="_top" href="#help_model_Advanced_ewsl_model_How.sweeped">参数扫描体</a> </td><td align="center"> <a target="_top" href="#help_model_Advanced_ewsl_model_How.column">垂直拉伸体</a> </td></tr><tr><td align="center"> <a target="_top" href="#help_model_Advanced_ewsl_model_How.cad">导入CAD模型</a> </td><td align="center"> <a target="_top" href="#help_model_Advanced_ewsl_model_How.meshsurface">强制网格面</a> </td><td align="center"> <a target="_top" href="#help_model_Advanced_ewsl_model_How.multilayer">多层物体</a> </td><td align="center"> <a target="_top" href="#help_model_Advanced_ewsl_model_How.radome">天线罩</a> </td><td align="center"> <a target="_top" href="#help_model_Advanced_ewsl_model_How.array">阵列</a> </td></tr></tbody></table></div></td></tr></table></div></blockquote><br /><a name="help_model_Advanced_ewsl_model_How.step4"> </a><h3>4.运行脚本文件</h3>保存脚本文件 &gt; 运行 EastWave V7 软件 &gt; 打开<strong>文件</strong>菜单 &gt; 选择<strong>打开</strong> &gt; 选中脚本文件 &gt; 单击<strong>打开</strong>运行脚本文件。<p><br /><br /></p></div>